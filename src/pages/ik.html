<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="UTF-8" />
    <meta name="google-adsense-account" content="ca-pub-2209781252231399" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Simulateur Indemnit√©s Kilom√©triques 2026 - Calcul Gratuit</title>
    <meta
      name="description"
      content="üöó Calculez vos indemnit√©s kilom√©triques 2026. Dernier bar√®me connu (auto/moto), simulation gratuite et d√©duction fiscale. R√©sultat imm√©diat !"
    />
    <meta
      name="keywords"
      content="indemnit√©s kilom√©triques (IK) 2026, bar√®me IK 2025, calcul indemnit√©s kilom√©triques, d√©duction fiscale km, frais r√©els professionnels, bar√®me urssaf indemnit√©s, calcul trajet domicile travail, remboursement km employeur, auto-entrepreneur frais d√©placement, calcul ik 5cv 7cv, indemnit√© kilom√©trique voiture √©lectrique, frais professionnels d√©ductibles 2026, simulation frais r√©els vs abattement 10%, bar√®me fiscal automobile, trajet professionnel d√©duction imp√¥ts"
    />
    <link rel="canonical" href="https://www.lescalculateurs.fr/pages/ik" />
    <script type="application/ld+json">
      {
        "@context": "https://schema.org",
        "@type": "BreadcrumbList",
        "itemListElement": [
          {
            "@type": "ListItem",
            "position": 1,
            "name": "Accueil",
            "item": "https://www.lescalculateurs.fr/"
          },
          {
            "@type": "ListItem",
            "position": 2,
            "name": "Indemnit√©s kilom√©triques",
            "item": "https://www.lescalculateurs.fr/pages/ik"
          }
        ]
      }
    </script>
    <script type="application/ld+json">
      {
        "@context": "https://schema.org",
        "@type": "WebPage",
        "name": "Indemnit√©s kilom√©triques",
        "url": "https://www.lescalculateurs.fr/pages/ik",
        "breadcrumb": {
          "@type": "BreadcrumbList",
          "itemListElement": [
            {
              "@type": "ListItem",
              "position": 1,
              "name": "Accueil",
              "item": "https://www.lescalculateurs.fr/"
            },
            {
              "@type": "ListItem",
              "position": 2,
              "name": "Indemnit√©s kilom√©triques",
              "item": "https://www.lescalculateurs.fr/pages/ik"
            }
          ]
        }
      }
    </script>
    <meta property="og:url" content="https://www.lescalculateurs.fr/pages/ik" />
    <meta property="og:type" content="website" />
    <meta
      property="og:title"
      content="Simulateur indemnit√©s kilom√©triques 2026 : Calcul frais d√©placement gratuit"
    />
    <meta
      property="og:description"
      content="üöó Calculez vos indemnit√©s kilom√©triques 2026. Dernier bar√®me connu (auto/moto), simulation gratuite. R√©sultat imm√©diat !"
    />
    <meta name="twitter:card" content="summary_large_image" />
    <meta
      name="twitter:title"
      content="Indemnit√©s Kilom√©triques ‚Äî Calcul automatique"
    />
    <meta
      name="twitter:description"
      content="üöó Calculez vos indemnit√©s kilom√©triques 2026. Dernier bar√®me connu (auto/moto), simulation gratuite. R√©sultat imm√©diat !"
    />

    <!-- JSON-LD Calculator Schema -->
    <script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "Calculator",
  "name": "Calculateur Indemnit√©s Kilom√©triques",
  "description": "calculez votre d√©duction d'indemnit√©s kilom√©triques (dernier bar√®me connu) - d√©ductible du revenu imposable",
  "url": "https://www.lescalculateurs.fr/pages/ik",
  "applicationCategory": "FinanceApplication",
  "screenshot": "https://www.lescalculateurs.fr/pages/ik",
  "isBasedOn": [
    "https://www.lescalculateurs.fr/pages/methodologie",
    "https://www.lescalculateurs.fr/pages/sources"
  ],
  "citation": [
    {
      "@type": "CreativeWork",
      "name": "Direction G√©n√©rale des Finances Publiques - Bar√®me IK",
      "url": "https://www.impots.gouv.fr"
    },
    {
      "@type": "CreativeWork",
      "name": "Service-public.fr ‚Äì Indemnit√©s kilom√©triques",
      "url": "https://www.service-public.fr/particuliers/vosdroits/F1410"
    },
    {
      "@type": "CreativeWork",
      "name": "Code G√©n√©ral des Imp√¥ts - Article 83",
      "url": "https://www.legifrance.gouv.fr"
    }
  ]
}</script>

    <!-- Sources Meta Tag for AI -->
    <meta
      name="source"
      content="impots.gouv.fr, service-public.fr, legifrance.gouv.fr"
    />
    <!-- Schema.org SoftwareApplication -->
    <script type="application/ld+json">
      {
        "@context": "https://schema.org",
        "@type": "SoftwareApplication",
        "name": "Simulateur IFI 2026",
        "operatingSystem": "Web",
        "applicationCategory": "FinanceApplication",
        "description": "Simulateur de l'imp√¥t sur la fortune immobili√®re selon le patrimoine.",
        "url": "https://www.lescalculateurs.fr/pages/isf-ifi",
        "offers": {
          "@type": "Offer",
          "price": "0",
          "priceCurrency": "EUR"
        }
      }
    </script>
    <script defer src="/third-party-loader.js"></script>
  <script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "FAQPage",
  "mainEntity": [
    {
      "@type": "Question",
      "name": "Comment conna√Ætre le montant estim√© des frais de notaire ?",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "Consultez un notaire ou utilisez les outils officiels des Notaires de France pour une estimation pr√©cise."
      }
    }
  ]
}
</script>
</head>
  <body class="bg-gray-50">
<div class="sticky-ymyl" role="alert" style="position:sticky;top:0;z-index:9999;background:#fff3cd;border:1px solid #ffc107;padding:12px 16px;text-align:center;font-size:14px;"><strong>‚ö†Ô∏è Estimation indicative.</strong> Montant d√©finitif sur <a href="https://www.service-public.fr/particuliers/vosdroits/F1989" target="_blank" rel="noopener" style="color:#856404;text-decoration:underline;font-weight:bold;">service-public.fr</a>.</div>


    <header class="bg-white shadow-sm">
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="flex justify-between items-center py-4">
          <a
            href="../index.html"
            class="text-primary-600 hover:text-primary-700 font-medium"
            >‚Üê Retour</a
          >
          <div class="text-center px-4">
            <h1 class="text-2xl font-bold text-gray-900">
              Simulateur indemnit√©s kilom√©triques 2026 : estimation selon le bar√®me fiscal
            </h1>
            <p class="text-sm text-gray-600 mt-1">
              Estimez vos indemnit√©s kilom√©triques 2026 selon vos kilom√®tres
              annuels et votre v√©hicule (simulation indicative bas√©e sur le
              bar√®me fiscal).
            </p>
          </div>
          <div></div>
        </div>

      <!-- ...existing code... -->
    </header>

    <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
      <div class="max-w-4xl mx-auto">
        <div class="bg-blue-50 border-l-4 border-blue-500 p-4 rounded-lg mb-8">
          <p class="text-blue-800 text-sm mb-2">
            <strong>üìå Simulation √† titre indicatif :</strong> Le bar√®me IK est
            utilis√© pour estimer des frais de d√©placement selon des r√®gles
            fiscales. Votre situation (trajets, justificatifs, frais r√©els) et
            la r√©glementation applicable d√©terminent le montant retenu.
          </p>
          <p class="text-blue-800 text-sm m-0">
            R√©sultat affich√© : indemnit√©s annuelles estim√©es et moyenne par km.
          </p>
        </div>
        <button
          data-scroll-target="#ik-calculator"
          data-scroll-focus="input, select, textarea"
          class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-8 rounded-lg text-lg transition-colors shadow-md mx-auto block"
          style="margin-bottom: 2.5rem;"
        >
          üü¢ Lancer la simulation
        </button>
      </div>

      <section class="max-w-4xl mx-auto mb-8">
        <div class="bg-white border border-gray-200 rounded-xl p-6">
          <h2 class="text-2xl font-bold text-gray-900 mb-4">üìå R√©sum√© rapide</h2>
          <div class="space-y-2 text-gray-700 text-sm">
            <p>üèõÔ∏è <strong>Source</strong> : impots.gouv.fr</p>
            <p>üìê <strong>Logique</strong> : calcul bas√© sur kilom√®tres annuels et v√©hicule</p>
            <p>üìÖ <strong>Ann√©e</strong> : param√®tres 2026</p>
            <p>‚ö†Ô∏è <strong>Important</strong> : r√©sultat non contractuel</p>
          </div>
        </div>
      </section>

      <section class="max-w-4xl mx-auto mb-8">
        <div class="bg-indigo-50 border border-indigo-100 rounded-xl p-6">
          <h2 class="text-2xl font-bold text-gray-900 mb-4">üßæ Ce que permet ce simulateur</h2>
          <ul class="list-disc list-inside space-y-2 text-gray-700">
            <li>Obtenir un <strong>montant indicatif</strong> d‚Äôindemnit√©s kilom√©triques</li>
            <li>Comprendre l‚Äôimpact de vos param√®tres (km, v√©hicule, puissance/cylindr√©e)</li>
            <li>Comparer plusieurs sc√©narios</li>
            <li>Croiser avec d‚Äôautres outils (imp√¥t, salaire, etc.)</li>
          </ul>
        </div>
      </section>

      <section class="max-w-4xl mx-auto mb-8">
        <div class="bg-white border border-gray-200 rounded-xl p-6">
          <h2 class="text-2xl font-bold text-gray-900 mb-4">üß≠ Guide rapide (avant de calculer)</h2>

          <h3 class="text-lg font-semibold text-gray-900 mb-2">üîπ Comment utiliser ce simulateur</h3>
          <ol class="list-decimal list-inside space-y-2 text-gray-700 text-sm mb-6">
            <li>Renseignez les informations demand√©es</li>
            <li>Indiquez vos montants ou param√®tres principaux</li>
            <li>Lancez la simulation</li>
            <li>Consultez le r√©sultat estimatif</li>
          </ol>

          <h3 class="text-lg font-semibold text-gray-900 mb-2">üîπ Comment lire les r√©sultats</h3>
          <ul class="list-disc list-inside space-y-2 text-gray-700 text-sm mb-6">
            <li><strong>Montant estim√©</strong> : ordre de grandeur</li>
            <li><strong>D√©tail</strong> : param√®tres pris en compte</li>
            <li><strong>Avertissement</strong> : d√©pend de votre situation r√©elle</li>
          </ul>

          <h3 class="text-lg font-semibold text-gray-900 mb-2">üîπ Pourquoi le r√©sultat peut √™tre nul / faible / diff√©rent</h3>
          <ul class="list-disc list-inside space-y-2 text-gray-700 text-sm">
            <li>D√©passement de seuils r√©glementaires</li>
            <li>Param√®tres non pris en compte dans une simulation simplifi√©e</li>
            <li>R√®gles sp√©cifiques propres √† votre dossier</li>
          </ul>
        </div>
      </section>

      <section class="max-w-4xl mx-auto mb-8">
        <div class="bg-gradient-to-r from-blue-50 to-indigo-50 border border-blue-100 rounded-lg p-6">
          <div class="flex flex-col gap-4 sm:flex-row sm:items-start sm:gap-6">
            <div class="text-4xl leading-none">üìä</div>
            <div class="flex-1">
              <h2 class="text-xl font-bold text-gray-900 mb-2">
                Comparez plusieurs trajets ou v√©hicules (facultatif)
              </h2>
              <p class="text-gray-700 mb-4">
                Faites un premier calcul, puis comparez des variantes (km, puissance, fr√©quence)
                pour visualiser l‚Äôimpact sur vos indemnit√©s annuelles.
              </p>
              <div class="grid sm:grid-cols-3 gap-4">
                <div class="bg-white rounded-lg p-4 shadow-sm">
                  <h3 class="font-bold text-gray-900 mb-1">üîÑ Multi‚Äësc√©narios</h3>
                  <p class="text-sm text-gray-600">
                    Comparez jusqu‚Äô√† 6 sc√©narios c√¥te √† c√¥te.
                  </p>
                </div>
                <div class="bg-white rounded-lg p-4 shadow-sm">
                  <h3 class="font-bold text-gray-900 mb-1">üéØ Sc√©narios typiques</h3>
                  <p class="text-sm text-gray-600">
                    ‚ÄúTrajet plus long‚Äù, ‚Äúautre v√©hicule‚Äù, ‚Äúautre fr√©quence‚Äù.
                  </p>
                </div>
                <div class="bg-white rounded-lg p-4 shadow-sm">
                  <h3 class="font-bold text-gray-900 mb-1">üí° Lecture simple</h3>
                  <p class="text-sm text-gray-600">
                    Indemnit√©s annuelles estim√©es et moyenne par km.
                  </p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>

      <div id="ik-calculator"></div>

      <div class="mt-6 flex justify-center gap-3">
        <button
          id="ik-add-to-compare"
          class="px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-semibold shadow-md transition-colors"
        >
          ‚ûï Ajouter √† la comparaison
        </button>
        <button
          id="ik-reset-compare"
          class="px-6 py-2 bg-gray-400 text-white rounded-lg hover:bg-gray-500 font-semibold shadow-md transition-colors hidden"
        >
          üîÑ R√©initialiser
        </button>
      </div>

      <div id="ik-comparaison" class="hidden mt-8"></div>

      <section class="mb-8">
        <div class="max-w-4xl mx-auto">
          <h2 class="text-3xl font-bold text-gray-900 mb-6">
            üßÆ Indemnit√©s kilom√©triques ‚Äî dernier bar√®me connu auto/moto
          </h2>

          <!-- AI Section: Question explicite -->
          <section class="ai-intro mb-6">
            <h2 class="text-xl font-bold text-gray-900 mb-2">
              üßÆ Indemnit√©s kilom√©triques 2026 ‚Äî bar√®me auto/moto, d√©claration
            </h2>
            <p class="ai-response text-gray-700">
              Indemnit√© = Kilom√®tres √ó Tarif bar√©matique (variable selon
              puissance du v√©hicule et kilom√©trage). Exemple voiture 5 CV :
              0,585‚Ç¨ jusqu'√† 5 000 km, 0,415‚Ç¨ de 5 001‚Äì20 000 km, 0,363‚Ç¨
              au-del√†. Le bar√®me fiscal est reconduit r√©guli√®rement; nous appliquons le dernier bar√®me connu.
            </p>
          </section>

          <!-- AI Section: R√©sum√© rapide -->
          <section class="ai-summary mb-6">
            <h3 class="text-lg font-bold text-gray-900 mb-3">
              üìå R√©sum√© rapide
            </h3>
            <ul class="space-y-2 text-gray-700">
              <li>
                <strong>Source:</strong> Administration fiscale (Imp√¥ts.gouv.fr)
                dernier bar√®me connu
              </li>
              <li>
                <strong>Calcul:</strong> Kilom√®tres √ó Tarif par tranche
                (d√©gressif selon km annuels)
              </li>
              <li>
                <strong>Particularit√©:</strong> Taux d√©gressif | Voitures 3‚Äì7 CV
                | Deux-roues jusqu'√† 750cc | D√©ductible fiscalement
              </li>
              <li>
                <strong>Outil:</strong> Simulation gratuite, bar√®me r√©glement√© en vigueur mis √†
                jour
              </li>
            </ul>
          </section>

          <div class="prose prose-lg text-gray-600">
            <p>
              Les indemnit√©s kilom√©triques permettent de d√©duire fiscalement les
              frais de d√©placement professionnel. Notre calculateur utilise le
              dernier bar√®me connu publi√© par l'administration fiscale pour
              calculer pr√©cis√©ment vos indemnit√©s selon la puissance de votre
              v√©hicule et le nombre de kilom√®tres parcourus.
              Que vous soyez salari√©, profession lib√©rale ou dirigeant
              d'entreprise, ces indemnit√©s constituent un avantage fiscal non
              n√©gligeable. Notre outil calcul√© automatiquement selon les
              tranches kilom√©triques : tarif d√©gressif jusqu'√† 5 000 km, puis de
              5 001 √† 20 000 km, et au-del√† de 20 000 km annuels. Compatible
              voitures et deux-roues.
            </p>
          </div>
        </div>
      </section>

      <section class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 mt-8">
        <div class="mt-12 bg-blue-50 rounded-lg p-6 border border-blue-200">
          <h3 class="font-bold text-blue-900 mb-3">üìö Sources officielles</h3>
          <ul class="text-sm text-gray-700 space-y-2">
            <li>
              ‚Ä¢ Frais professionnels (bar√®me kilom√©trique ‚Äì cadre fiscal) :
              <a href="https://www.service-public.fr/particuliers/vosdroits/F1989" target="_blank" rel="noopener" class="text-blue-600 hover:underline">service-public.fr</a>
            </li>
            <li>
              ‚Ä¢ Bar√®mes kilom√©triques (voitures et deux‚Äëroues) :
              <a href="https://www.service-public.fr/particuliers/actualites/A14686" target="_blank" rel="noopener" class="text-blue-600 hover:underline">service-public.fr ‚Äì Actualit√©s</a>
            </li>
            <li>
              ‚Ä¢ Informations et FAQ officielles :
              <a href="https://www.impots.gouv.fr/particulier/questions/lutilisation-du-bar√®me-kilometrique-est-elle-obligatoire-pour-evaluer-mes" target="_blank" rel="noopener" class="text-blue-600 hover:underline">impots.gouv.fr</a>
            </li>
          </ul>
        </div>
      </section>

      <!-- AI Section: Donn√©es utilis√©es pour ce calcul -->
      <section class="max-w-4xl mx-auto mb-8">
        <div class="ai-calculation-data">
          <h3 class="text-lg font-bold text-gray-900 mb-4">
            ‚öôÔ∏è Donn√©es utilis√©es pour ce calcul
          </h3>
          <ul class="space-y-2 text-gray-700 mb-4">
            <li>
              <strong>Dernier bar√®me publi√© (voitures) :</strong> tarifs par
              puissance fiscale (3‚Äì7 CV)
            </li>
            <li>
              <strong>Dernier bar√®me publi√© (deux‚Äëroues) :</strong> tarifs par
              cylindr√©e
              (&lt; 50cc, 50‚Äì125cc, &gt; 125cc)
            </li>
            <li>
              <strong>Tranches kilom√©triques:</strong> Jusqu'√† 5 000 km | 5
              001‚Äì20 000 km | &gt; 20 000 km annuels
            </li>
            <li>
              <strong>D√©ductibilit√© fiscale:</strong> Frais professionnels
              d√©ductibles du revenu imposable
            </li>
            <li>
              <strong>R√©f√©rence:</strong> CGI article 83 (frais r√©els) et
              documentation officielle
            </li>
          </ul>
          <p class="text-sm text-gray-600">
            <strong>Derni√®re mise √† jour:</strong> janvier 2026 (sources
            officielles)
          </p>
        </div>
      </section>
    </main>

    <section class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 mt-8">
      <div class="bg-white border-2 border-gray-200 rounded-lg p-6">
        <h3 class="text-xl font-bold text-gray-900 mb-3">üîó Voir aussi</h3>
        <p class="text-sm text-gray-600 mb-3">
          Parcours travail/fiscal :
          <a href="/pages/ik.html" class="text-blue-700 hover:underline">IK</a>
          ‚Üí
          <a href="/pages/impot.html" class="text-blue-700 hover:underline">Imp√¥t</a>
          ‚Üí
          <a href="/pages/salaire.html" class="text-blue-700 hover:underline">Salaire</a>
          ‚Üí
          <a href="/pages/travail.html" class="text-blue-700 hover:underline">Temps</a>
        </p>
        <div class="flex flex-wrap gap-3">
          <a
            href="/pages/impot.html"
            class="inline-block bg-white border border-gray-300 rounded px-3 py-2 text-sm text-blue-700 hover:bg-blue-50"
            >Imp√¥t sur le revenu</a
          >
          <a
            href="/pages/salaire.html"
            class="inline-block bg-white border border-gray-300 rounded px-3 py-2 text-sm text-blue-700 hover:bg-blue-50"
            >Salaire brut/net</a
          >
          <a
            href="/pages/apl.html"
            class="inline-block bg-white border border-gray-300 rounded px-3 py-2 text-sm text-blue-700 hover:bg-blue-50"
            >APL 2026</a
          >
          <a
            href="/pages/notaire.html"
            class="inline-block bg-white border border-gray-300 rounded px-3 py-2 text-sm text-blue-700 hover:bg-blue-50"
            >Frais de notaire</a
          >
          <a
            href="/pages/pret.html"
            class="inline-block bg-white border border-gray-300 rounded px-3 py-2 text-sm text-blue-700 hover:bg-blue-50"
            >Mensualit√© de pr√™t</a
          >
          <a
            href="/pages/plusvalue.html"
            class="inline-block bg-white border border-gray-300 rounded px-3 py-2 text-sm text-blue-700 hover:bg-blue-50"
            >Plus‚Äëvalue immobili√®re</a
          >
          <a
            href="/pages/charges.html"
            class="inline-block bg-white border border-gray-300 rounded px-3 py-2 text-sm text-blue-700 hover:bg-blue-50"
            >Charges de copropri√©t√©</a
          >
          <a
            href="/pages/taxe.html"
            class="inline-block bg-white border border-gray-300 rounded px-3 py-2 text-sm text-blue-700 hover:bg-blue-50"
            >Taxe fonci√®re</a
          >
          <a
            href="/pages/travail.html"
            class="inline-block bg-white border border-gray-300 rounded px-3 py-2 text-sm text-blue-700 hover:bg-blue-50"
            >Temps de travail</a
          >
          <a
            href="/pages/blog/frais-notaire-departements.html"
            class="inline-block bg-blue-600 text-white rounded px-4 py-2 text-sm font-semibold shadow hover:bg-blue-700"
            >Tous les d√©partements</a
          >
          <a
            href="/pages/blog.html"
            class="inline-block bg-white border border-gray-300 rounded px-3 py-2 text-sm text-blue-700 hover:bg-blue-50"
            >Blog</a
          >
        </div>
      </div>
    </section>

    

    <script type="module" src="../main.ts"></script>
    <script type="module">
      import { CalculatorFrame } from "../components/CalculatorFrame.ts";
      import { formatCurrency } from "../main.ts";
      import { baremes } from "../data/baremes.ts";

      const ikConfig = {
        title: "Indemnit√©s kilom√©triques 2026 ‚Äî bar√®me auto/moto, d√©claration",
        description: "calculez vos indemnit√©s selon le bar√®me fiscal, avec d√©claration simplifi√©e.",
        fields: [
          {
            id: "type_vehicule",
            label: "Type de v√©hicule",
            type: "select",
            required: true,
            options: [
              { value: "voiture", label: "Voiture" },
              { value: "deux_roues", label: "Deux-roues" },
            ],
          },
          {
            id: "puissance",
            label: "Puissance fiscale (CV)",
            type: "select",
            required: true,
            options: [
              { value: "3CV et moins", label: "3 CV et moins" },
              { value: "4CV", label: "4 CV" },
              { value: "5CV", label: "5 CV" },
              { value: "6CV", label: "6 CV" },
              { value: "7CV et plus", label: "7 CV et plus" },
            ],
          },
          {
            id: "cylindree_moto",
            label: "Cylindr√©e (deux-roues)",
            type: "select",
            required: false,
            options: [
              { value: "moins_50cc", label: "Moins de 50cc" },
              { value: "50cc_125cc", label: "50cc √† 125cc" },
              { value: "plus_125cc", label: "Plus de 125cc" },
            ],
          },
          {
            id: "kilometres",
            label: "Nombre de kilom√®tres annuels",
            type: "number",
            required: true,
            placeholder: "15000",
            min: 1,
            step: 1,
          },
        ],
        calculate: (values) => {
          try {
            const typeVehicule = values.type_vehicule;
            const kilometres = Number(values.kilometres);

            if (!typeVehicule) {
              return {
                success: false,
                error: "Veuillez s√©lectionner le type de v√©hicule.",
              };
            }
            if (!isFinite(kilometres) || kilometres <= 0) {
              return {
                success: false,
                error: "Veuillez saisir un nombre de kilom√®tres valide.",
              };
            }

            let indemniteParKm = 0;
            let total = 0;

            if (typeVehicule === "voiture") {
              const puissance = values.puissance;
              if (!puissance) {
                return {
                  success: false,
                  error: "Veuillez s√©lectionner la puissance fiscale (CV).",
                };
              }
              const tableVoiture = baremes.indemnites_kilometriques.voiture.latest || baremes.indemnites_kilometriques.voiture["2024"];
              const bar√®mePuissance = tableVoiture.find((b) => b.puissance === puissance);
              if (!bar√®mePuissance) {
                return {
                  success: false,
                  error: "Puissance non trouv√©e dans le bar√®me r√©glement√© en vigueur.",
                };
              }
              if (kilometres <= 5000) {
                total = kilometres * bar√®mePuissance.jusqu_5000;
                indemniteParKm = bar√®mePuissance.jusqu_5000;
              } else if (kilometres <= 20000) {
                total =
                  5000 * bar√®mePuissance.jusqu_5000 +
                  (kilometres - 5000) * bar√®mePuissance.de_5001_20000;
                indemniteParKm = total / kilometres;
              } else {
                total =
                  5000 * bar√®mePuissance.jusqu_5000 +
                  15000 * bar√®mePuissance.de_5001_20000 +
                  (kilometres - 20000) * bar√®mePuissance.au_dela_20000;
                indemniteParKm = total / kilometres;
              }
            } else {
              const cylindree = values.cylindree_moto;
              if (!cylindree) {
                return {
                  success: false,
                  error: "Veuillez s√©lectionner la cylindr√©e (deux-roues).",
                };
              }
              const ik = baremes.indemnites_kilometriques.deux_roues[cylindree];
              if (!isFinite(ik)) {
                return {
                  success: false,
                  error: "Cylindr√©e non trouv√©e dans le bar√®me.",
                };
              }
              indemniteParKm = ik;
              total = kilometres * indemniteParKm;
            }

            return {
              success: true,
              data: {
                total,
                indemniteParKm,
                kilometres,
                typeVehicule,
                puissance: values.puissance,
                cylindree: values.cylindree_moto,
              },
            };
          } catch (error) {
            return {
              success: false,
              error: "Erreur lors du calcul. V√©rifiez vos donn√©es.",
            };
          }
        },
        formatResult: (result) => {
          const data = result.data;
          return `
          <div class="space-y-6">
            <div class="bg-white rounded-lg p-6 border border-gray-200 shadow-sm">
              <h3 class="text-xl font-bold text-gray-900 mb-4">üéØ R√©sultat principal</h3>
              <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
                  <p class="text-sm text-gray-600">Distance annuelle</p>
                  <p class="text-2xl font-bold text-blue-700">${data.kilometres.toLocaleString(
                    "fr-FR"
                  )} km</p>
                </div>
                <div class="bg-green-50 border border-green-200 rounded-lg p-4">
                  <p class="text-sm text-gray-600">Indemnit√©s totales (annuel)</p>
                  <p class="text-2xl font-bold text-green-700">${formatCurrency(
                    data.total
                  )}</p>
                </div>
                <div class="bg-purple-50 border border-purple-200 rounded-lg p-4">
                  <p class="text-sm text-gray-600">Mensuel (sur 12 mois)</p>
                  <p class="text-2xl font-bold text-purple-700">${formatCurrency(
                    data.total / 12
                  )}</p>
                </div>
              </div>
              <p class="text-sm text-gray-600 mt-3 m-0">
                Indemnit√© moyenne par km : <strong>${data.indemniteParKm.toFixed(
                  3
                )} ‚Ç¨</strong>
              </p>
            </div>
            
            <div class="border-t pt-4">
              <div class="space-y-2 text-sm">
                <div class="flex justify-between">
                  <span>Type de v√©hicule :</span>
                  <span class="font-medium">${
                    data.typeVehicule === "voiture" ? "Voiture" : "Deux-roues"
                  }</span>
                </div>
                ${
                  data.puissance
                    ? `
                <div class="flex justify-between">
                  <span>Puissance fiscale :</span>
                  <span class="font-medium">${data.puissance}</span>
                </div>
                `
                    : ""
                }
                ${
                  data.cylindree
                    ? `
                <div class="flex justify-between">
                  <span>Cylindr√©e :</span>
                  <span class="font-medium">${data.cylindree.replace(
                    "_",
                    " "
                  )}</span>
                </div>
                `
                    : ""
                }
              </div>
            </div>

            <div class="bg-orange-50 border border-orange-200 rounded-lg p-4 mt-4">
              <p class="text-sm text-orange-800">
                <strong>‚ö†Ô∏è Attention :</strong>Bar√®me 2024 (dernier publi√©). En l'absence de publication du bar√®me 2026, ce simulateur applique le dernier bar√®meconnu, reconduit par l'administration.</p>
            </div>
            <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-4 mt-4">
              <p class="text-sm text-yellow-900">
                <strong>Important :</strong> Les indemnit√©s kilom√©triques (IK) ne s'appliquent que si vous optez pour la d√©duction des frais r√©els. Elles ne sont pas cumulables avec l'abattement forfaitaire de 10 %.
              </p>
            </div>
            <div class="bg-blue-50 border border-blue-200 rounded-lg p-4 mt-4">
              <p class="text-sm text-blue-800">
                <strong>√Ä savoir :</strong> Ces indemnit√©s sont d√©ductibles fiscalement et doivent √™tre 
                d√©clar√©es dans vos frais r√©els ou rembours√©es par votre employeur.
              </p>
            </div>
          </div>
        `;
        },
        exportCSV: {
          enabled: true,
          filename: "indemnites-kilometriques-estimation.csv",
          getCSVData: (result, values) => {
            const data = result.data;
            return {
              headers: ["Param√®tre", "Valeur"],
              rows: [
                [
                  "Type de v√©hicule",
                  data.typeVehicule === "voiture" ? "Voiture" : "Deux-roues",
                ],
                ["Distance annuelle (km)", data.kilometres],
                ["Indemnit√© par km (‚Ç¨)", data.indemniteParKm.toFixed(3)],
                ["Indemnit√©s totales (‚Ç¨)", data.total],
                ...(data.puissance
                  ? [["Puissance fiscale", data.puissance]]
                  : []),
                ...(data.cylindree
                  ? [["Cylindr√©e", data.cylindree.replace("_", " ")]]
                  : []),
              ],
            };
          },
        },
      };

      // Masquer/afficher les champs selon le type de v√©hicule
      document.addEventListener("DOMContentLoaded", () => {
        setTimeout(() => {
          const typeSelect = document.getElementById("type_vehicule");
          const puissanceDiv = document
            .getElementById("puissance")
            ?.closest("div");
          const cylindreeDiv = document
            .getElementById("cylindree_moto")
            ?.closest("div");

          function toggleFields() {
            const type = typeSelect?.value;
            if (puissanceDiv)
              puissanceDiv.style.display =
                type === "voiture" ? "block" : "none";
            if (cylindreeDiv)
              cylindreeDiv.style.display =
                type === "deux_roues" ? "block" : "none";
          }

          typeSelect?.addEventListener("change", toggleFields);
          toggleFields();
        }, 100);
      });

      new CalculatorFrame("ik-calculator", ikConfig);
    </script>

    <!-- Gestion de la comparaison IK -->
    <script type="module" src="./scripts/ik-script.ts"></script>

    <!-- Auto-initialisation des exports PDF/CSV -->
    <script type="module">
  const __lcLoadAutoExport = () => import("../utils/autoExportInit.js");
  if ("requestIdleCallback" in window) {
    window.requestIdleCallback(__lcLoadAutoExport, { timeout: 4000 });
  } else {
    window.setTimeout(__lcLoadAutoExport, 2000);
  }
</script>

    <footer class="bg-gray-800 text-white py-8 mt-16">
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="flex flex-col items-center space-y-4">
          <p class="text-gray-300">
            ¬© 2026 Les Calculateurs - Indemnit√©s kilom√©triques selon bar√®mes
            officiels
          </p>
          <div class="flex gap-4 text-sm">
            <a
              href="/pages/methodologie"
              class="text-gray-300 hover:text-white transition-colors"
              >üìö Notre M√©thodo</a
            >
            <span class="text-gray-500">|</span>
            <a
              href="/pages/sources"
              class="text-gray-300 hover:text-white transition-colors"
              >üèõÔ∏è Sources Officielles</a
            >
            <span class="text-gray-500">|</span>
            <a
              href="/pages/historique-mises-a-jour"
              class="text-gray-300 hover:text-white transition-colors"
              >üîÑ Mises √† jour</a
            >
          </div>
        </div>
      </div>
    </footer>
  <div class="ymyl-officiel-btn" style="text-align:center;margin:20px 0;"><a class="btn-officiel" href="https://www.notaires.fr" target="_blank" rel="noopener" style="display:inline-block;background:#007bff;color:#fff;padding:12px 24px;border-radius:4px;text-decoration:none;font-weight:bold;">üëâ estimateur gratuit notaires.fr</a><p style="font-size:12px;color:#666;margin-top:8px;">Pour un calcul d√©finitif conforme aux bar√®mes en vigueur</p></div>

<!-- YMYL Verbalization Script -->
<script>(function() {
  'use strict';
  
  // Configuration par type
  const CONFIG = {
    APL: { source: 'CAF', url: 'https://www.caf.fr' },
    IMPOT: { source: 'impots.gouv.fr', url: 'https://www.impots.gouv.fr' },
    NOTAIRE: { source: 'notaires.fr', url: 'https://www.notaires.fr' },
    RSA: { source: 'CAF', url: 'https://www.caf.fr' },
    PRIME: { source: 'CAF', url: 'https://www.caf.fr' },
    IK: { source: 'impots.gouv.fr', url: 'https://www.impots.gouv.fr' },
    SALAIRE: { source: '', url: 'https://www.impots.gouv.fr' },
    PRET: { source: 'banque', url: '#' },
    TAXE: { source: 'impots.gouv.fr', url: 'https://www.impots.gouv.fr' },
    PLUSVALUE: { source: 'notaire', url: 'https://www.notaires.fr' }
  };
  
  // Detecter le type de simulateur
  function detectType() {
    const path = window.location.pathname.toLowerCase();
    if (path.includes('apl')) return 'APL';
    if (path.includes('impot')) return 'IMPOT';
    if (path.includes('notaire')) return 'NOTAIRE';
    if (path.includes('rsa')) return 'RSA';
    if (path.includes('prime')) return 'PRIME';
    if (path.includes('ik') || path.includes('kilometrique')) return 'IK';
    if (path.includes('salaire')) return 'SALAIRE';
    if (path.includes('pret')) return 'PRET';
    if (path.includes('taxe')) return 'TAXE';
    if (path.includes('plus-value')) return 'PLUSVALUE';
    return 'GENERIC';
  }
  
  // Verbaliser un montant
  function verbalize(value) {
    const num = parseInt(value);
    if (isNaN(num) || num< 10) return value;
    const rounded = Math.round(num / 10) * 10;
    return 'environ ' + rounded + ' ‚Ç¨';
  }
  
  // Traiter un element
  function processElement(el, type) {
    const text = el.textContent || el.innerText || '';
    const match = text.match(/(d[ds]{2,5})s*‚Ç¨/);
    if (!match) return;
    
    const exactVal = match[1].replace(/s/g, '');
    const verbalVal = verbalize(exactVal);
    const config = CONFIG[type] || CONFIG.GENERIC;
    
    // Remplacer contenu
    el.innerHTML = '<span class="ymyl-verbal" style="color:inherit;">' + verbalVal + '</span>' +
                   '<span class="ymyl-exact" style="display:none;">' + exactVal + ' ‚Ç¨</span>' +
                   '<small style="display:block;color:#666;font-size:0.8em;margin-top:2px;">valeur indicative ‚Äì voir ' + config.source + ' pour montant estim√©</small>';
  }
  
  // Observer les changements DOM
  const observer = new MutationObserver(function(mutations) {
    const type = detectType();
    mutations.forEach(function(mutation) {
      mutation.addedNodes.forEach(function(node) {
        if (node.nodeType === 1) { // Element
          // Chercher dans les resultats
          const results = node.querySelectorAll ? 
            node.querySelectorAll('.result, .montant, [class*="result"], [class*="montant"], output, .calculator-result, #calculator-result') : [];
          results.forEach(function(el) {
            if (el.textContent.includes('‚Ç¨')) {
              processElement(el, type);
            }
          });
        }
      });
    });
  });
  
  // Demarrer observation
  document.addEventListener('DOMContentLoaded', function() {
    const type = detectType();
    
    // Traiter elements existants
    document.querySelectorAll('.result, .montant, [class*="result"], [class*="montant"], output, .calculator-result, #calculator-result, strong, span').forEach(function(el) {
      if (el.textContent.match(/d{3,6}s*‚Ç¨/)) {
        processElement(el, type);
      }
    });
    
    // Observer nouveaux elements
    observer.observe(document.body, { childList: true, subtree: true });
  });
})();
</script>

</body>
</html>
