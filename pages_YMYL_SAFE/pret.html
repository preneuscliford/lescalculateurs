<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Simulateur prÃªt immobilier 2026 â€“ MensualitÃ©s &amp; capacitÃ©</title>
    <meta name="description" content="Simulez votre prÃªt immobilier en 2026. MensualitÃ©s, taux, capacitÃ© dâ€™emprunt et financement total gratuitement." />
    <meta
      name="keywords"
      content="simulation prÃªt immobilier 2026, simulateur prÃªt immobilier, comment simuler un prÃªt immobilier, capacitÃ© dâ€™emprunt, mensualitÃ© prÃªt immobilier, coÃ»t total crÃ©dit, taux dâ€™endettement 35%, indicateur dâ€™effort, assurance emprunteur, TAEG estimÃ©, frais de dossier, frais de garantie, prÃªt immobilier vs prÃªt conso, simulateur crÃ©dit conso"
    />
    <meta name="google-adsense-account" content="ca-pub-2209781252231399">
    <!-- Google AdSense -->
    <script
      async
      src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2209781252231399"
      crossorigin="anonymous"
    ></script>
    <!-- Google Tag Manager -->
    <script>
      (function (w, d, s, l, i) {
        w[l] = w[l] || [];
        w[l].push({ "gtm.start": new Date().getTime(), event: "gtm.js" });
        var f = d.getElementsByTagName(s)[0],
          j = d.createElement(s),
          dl = l != "dataLayer" ? "&l=" + l : "";
        j.async = true;
        j.src = "https://www.googletagmanager.com/gtm.js?id=" + i + dl;
        f.parentNode.insertBefore(j, f);
      })(window, document, "script", "dataLayer", "GTM-TPFZCGX5");
    </script>
    <!-- End Google Tag Manager -->
    <!-- Google tag (gtag.js) -->
    <script
      async
      src="https://www.googletagmanager.com/gtag/js?id=G-2HNTGCYQ1X"
    ></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag() {
        dataLayer.push(arguments);
      }
      gtag("js", new Date());

      gtag("config", "G-2HNTGCYQ1X");
    </script>

    <!-- SEO & Social -->
    <link rel="canonical" href="https://www.lescalculateurs.fr/pages/pret" />
    <meta property="og:url" content="https://www.lescalculateurs.fr/pages/pret" />
    <meta property="og:type" content="website" />
    <meta property="og:title" content="Simulateur prÃªt immobilier 2026 â€“ MensualitÃ©s &amp; capacitÃ©" />
    <meta property="og:description" content="Simulez votre prÃªt immobilier en 2026. MensualitÃ©s, taux, capacitÃ© dâ€™emprunt et financement total gratuitement." />
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="Simulateur prÃªt immobilier 2026 â€“ MensualitÃ©s &amp; capacitÃ©" />
    <meta name="twitter:description" content="Simulez votre prÃªt immobilier en 2026. MensualitÃ©s, taux, capacitÃ© dâ€™emprunt et financement total gratuitement." />

    <!-- JSON-LD: BreadcrumbList & FAQPage -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "BreadcrumbList",
      "itemListElement": [
        {
          "@type": "ListItem",
          "position": 1,
          "name": "Accueil",
          "item": "https://www.lescalculateurs.fr/index"
        },
        {
          "@type": "ListItem",
          "position": 2,
          "name": "PrÃªt immobilier",
          "item": "https://www.lescalculateurs.fr/pages/pret"
        }
      ]
    }
    </script>
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "FAQPage",
      "mainEntity": [
        {
          "@type": "Question",
          "name": "Comment calculer ma capacitÃ© d'emprunt maximale ?",
          "acceptedAnswer": {"@type": "Answer", "text": "Votre capacitÃ© dÃ©pend de vos revenus, de vos charges et du taux d'endettement (souvent ~35% assurance incluse). Le simulateur calcule automatiquement les mensualitÃ©s et le taux d'endettement estimÃ©."}
        },
        {
          "@type": "Question",
          "name": "Quels sont les taux de prÃªt immobilier en 2026 ?",
          "acceptedAnswer": {"@type": "Answer", "text": "Les taux varient selon la durÃ©e et le profil. Sur 20 ans, comptez environ 3,5â€“4,5% pour un trÃ¨s bon dossier. Le simulateur utilise des taux moyens actualisÃ©s."}
        },
        {
          "@type": "Question",
          "name": "L'assurance emprunteur est-elle obligatoire ?",
          "acceptedAnswer": {"@type": "Answer", "text": "Non lÃ©galement, mais exigÃ©e par les banques. En moyenne 0,3â€“0,6% du capital selon l'Ã¢ge/santÃ©. La loi Lemoine permet de choisir son assureur."}
        },
        {
          "@type": "Question",
          "name": "Quels frais annexes prÃ©voir ?",
          "acceptedAnswer": {"@type": "Answer", "text": "Frais de dossier (0,5â€“1%), garantie (hypothÃ¨que/caution 1â€“2%), courtage Ã©ventuel. Le simulateur intÃ¨gre ces coÃ»ts pour un calcul rÃ©aliste."}
        }
      ]
    }
    </script>

    <!-- Favicon -->
    <link rel="apple-touch-icon" sizes="180x180" href="../assets/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="../assets/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="../assets/favicon-16x16.png">
    <link rel="manifest" href="../assets/site.webmanifest">
    <link rel="shortcut icon" href="../assets/favicon.ico">

    <script defer src="/third-party-loader.js"></script>
    
    <!-- JSON-LD Calculator Schema -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "Calculator",
      "name": "Calculateur PrÃªt Immobilier 2026",
      "description": "Calculez vos mensualitÃ©s de prÃªt immobilier et votre capacitÃ© d'emprunt en 2026 - taux actualisÃ©s, assurance incluse",
      "url": "https://www.lescalculateurs.fr/pages/pret",
      "applicationCategory": "FinanceApplication",
      "screenshot": "https://www.lescalculateurs.fr/pages/pret",
      "isBasedOn": [
        "https://www.lescalculateurs.fr/pages/methodologie",
        "https://www.lescalculateurs.fr/pages/sources"
      ],
      "citation": [
        {
          "@type": "Organization",
          "name": "Banque de France",
          "url": "https://www.banque-france.fr"
        },
        {
          "@type": "CreativeWork",
          "name": "Service-public.fr â€“ CrÃ©dit immobilier",
          "url": "https://www.service-public.fr/particuliers/vosdroits/N20373"
        },
        {
          "@type": "CreativeWork",
          "name": "DVF â€“ data.gouv.fr",
          "url": "https://www.data.gouv.fr"
        }
      ]
    }
    </script>

    <!-- Sources Meta Tag for AI -->
    <meta name="source" content="banque-france.fr, service-public.fr, data.gouv.fr">
    <!-- Schema.org SoftwareApplication -->
    <script type="application/ld+json">
      {
        "@context": "https://schema.org",
        "@type": "SoftwareApplication",
        "name": "Simulateur de prÃªt immobilier",
        "operatingSystem": "Web",
        "applicationCategory": "FinanceApplication",
        "description": "Simulateur de crÃ©dit immobilier pour estimer mensualitÃ©s, capacitÃ© d'emprunt et coÃ»t total du financement.",
        "url": "https://www.lescalculateurs.fr/pages/pret-immobilier",
        "offers": {
          "@type": "Offer",
          "price": "0",
          "priceCurrency": "EUR"
        }
      }
    </script>
  <script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "FAQPage",
  "mainEntity": [
    {
      "@type": "Question",
      "name": "Comment connaitre le montant exact des frais de notaire ?",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "Consultez un notaire ou utilisez les outils officiels des Notaires de France pour une estimation precise."
      }
    }
  ]
}
</script>
</head>
  <body class="bg-gray-50">
    <!-- Google Tag Manager (noscript) -->
    <noscript
      ><iframe
        src="https://www.googletagmanager.com/ns.html?id=GTM-TPFZCGX5"
        height="0"
        width="0"
        style="display: none; visibility: hidden"
      ></iframe
    ></noscript>
    <!-- End Google Tag Manager (noscript) -->

<div class="sticky-ymyl" role="alert" style="position:sticky;top:0;z-index:9999;background:#fff3cd;border:1px solid #ffc107;padding:12px 16px;text-align:center;font-size:14px;"><strong>âš ï¸ Estimation indicative.</strong> Montant definitif sur <a href="https://www.notaires.fr" target="_blank" rel="noopener" style="color:#856404;text-decoration:underline;font-weight:bold;">notaires.fr</a> ou <a href="/simulateur" style="color:#856404;text-decoration:underline;">simulateur officiel</a>.</div>

    <header class="bg-white shadow-sm border-b border-gray-200">
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="flex flex-col gap-3 py-4 sm:flex-row sm:justify-between sm:items-center">
          <!-- Logo & Navigation -->
          <div class="flex items-center gap-4 flex-wrap">
            <img src="/assets/lescalculateurs-new-logo.png" alt="LesCalculateurs.fr" class="h-10 w-auto">
            <a href="../index.html" class="flex items-center space-x-2 text-blue-600 hover:text-blue-700 font-medium transition-colors">
              <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"></path>
              </svg>
              <span>ðŸ  Accueil</span>
            </a>
            <div class="hidden sm:block">
              <span class="text-gray-400">|</span>
            </div>
            <div class="hidden sm:flex items-center space-x-2">
              <div class="bg-green-100 text-green-700 rounded-lg p-1.5">
                <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                  <path d="M4 7a2 2 0 012-2h8a2 2 0 012 2v10a2 2 0 01-2 2H6a2 2 0 01-2-2V7zm3 3a1 1 0 000 2h6a1 1 0 100-2H7z"></path>
                </svg>
              </div>
              <span class="text-sm font-medium text-gray-700">PrÃªt Immobilier</span>
            </div>
          </div>

          <!-- Title & Status -->
          <div class="sm:flex-1 sm:flex sm:justify-center">
            <!-- Bloc dÃ©placÃ© sous l'avertissement -->
          </div>

          <!-- Actions -->
          <div class="flex items-center space-x-2">
            <div class="hidden md:block">
              <span class="text-xs text-gray-500">Taux actuels</span>
            </div>
          </div>
        </div>
      </div>
    </header>

    <main class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-12">
      <div class="mb-6 p-4 bg-yellow-50 border border-yellow-200 rounded-lg">
        <p class="text-sm text-gray-800 m-0">
          Les calculs reposent sur des formules standard d'amortissement et des
          hypothÃ¨ses simplifiÃ©es (assurance, frais). Ils constituent une
          estimation indicative et non contractuelle.
        </p>
      </div>

      <div class="flex flex-col items-center mt-6 mb-8">
        <div class="flex items-center gap-3">
          <h1 class="text-2xl sm:text-3xl font-bold text-gray-900">
            Simulateur prÃªt immobilier : mensualitÃ©s et capacitÃ© dâ€™emprunt
          </h1>
        </div>
        <p class="text-sm text-gray-600 mt-2 text-center">
          Calculez vos mensualitÃ©s et votre capacitÃ© dâ€™emprunt selon le montant, la durÃ©e et le taux de crÃ©dit immobilier (estimation indicative).
        </p>
        <button
          data-scroll-target="#calculator-container"
          data-scroll-focus="input, select, textarea"
          class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-8 rounded-lg text-lg transition-colors shadow-md mt-6"
        >
          ðŸŸ¢ Lancer la simulation
        </button>
      </div>
      </div>

      <div class="bg-blue-50 border-l-4 border-blue-500 p-4 rounded-lg mb-8">
        <p class="text-blue-800 text-sm mb-2">
          <strong>ðŸ“Œ Simulation Ã  titre indicatif :</strong> Ce simulateur
          affiche un indicateur d'effort basÃ© sur le reste Ã  vivre (revenus âˆ’
          charges) et un taux d'endettement indicatif au sens bancaire
          (mensualitÃ©s de crÃ©dit + charges) / revenus.
        </p>
        <p class="text-blue-800 text-sm m-0">
          Les frais (dossier, garantie) sont gÃ©nÃ©ralement payÃ©s Ã  part ; ils
          sont pris en compte dans le coÃ»t total et le TAEG estimÃ©.
        </p>
      </div>

      <section class="mb-8 bg-gradient-to-r from-blue-50 to-indigo-50 border border-blue-100 rounded-lg p-6">
        <div class="flex flex-col gap-4 sm:flex-row sm:items-start sm:gap-6">
          <div class="text-4xl leading-none">ðŸ“Š</div>
          <div class="flex-1">
            <h2 class="text-xl font-bold text-gray-900 mb-2">
              Comparez plusieurs montages de prÃªt (facultatif)
            </h2>
            <p class="text-gray-700 mb-4">
              Faites un premier calcul, puis testez une variante (durÃ©e, taux, apport, assurance)
              pour voir immÃ©diatement lâ€™impact sur la mensualitÃ©, le coÃ»t total et lâ€™effort.
            </p>
            <div class="grid sm:grid-cols-3 gap-4">
              <div class="bg-white rounded-lg p-4 shadow-sm">
                <h3 class="font-bold text-gray-900 mb-1">ðŸ”„ Comparaison</h3>
                <p class="text-sm text-gray-600">
                  Ajoutez des scÃ©narios et comparez les Ã©carts.
                </p>
              </div>
              <div class="bg-white rounded-lg p-4 shadow-sm">
                <h3 class="font-bold text-gray-900 mb-1">ðŸ’¡ Indicateurs clÃ©s</h3>
                <p class="text-sm text-gray-600">
                  MensualitÃ©, coÃ»t total, TAEG et effort bancaire estimÃ©.
                </p>
              </div>
              <div class="bg-white rounded-lg p-4 shadow-sm">
                <h3 class="font-bold text-gray-900 mb-1">ðŸ“¥ Export</h3>
                <p class="text-sm text-gray-600">
                  TÃ©lÃ©chargez vos rÃ©sultats (PDF / CSV selon options).
                </p>
              </div>
            </div>
          </div>
        </div>
      </section>

      <div id="calculator-container"></div>

      <div class="mt-6 flex justify-center gap-3">
        <button
          id="pret-add-to-compare"
          class="px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-semibold shadow-md transition-colors"
        >
          âž• Ajouter Ã  la comparaison
        </button>
        <button
          id="pret-reset-compare"
          class="px-6 py-2 bg-gray-400 text-white rounded-lg hover:bg-gray-500 font-semibold shadow-md transition-colors hidden"
        >
          ðŸ”„ RÃ©initialiser
        </button>
      </div>

      <div id="pret-comparaison" class="hidden mt-8"></div>

      <!-- Intro SEO -->
      <section class="mb-12">
        <h2 class="text-3xl font-bold text-gray-900 mb-4">
          ðŸ¦ Simulateur PrÃªt Immobilier 2026
        </h2>

        <!-- AI Section: Question explicite -->
        <section class="ai-intro mb-6">
          <h2 class="text-xl font-bold text-gray-900 mb-2">â“ Quel est le coÃ»t rÃ©el de votre prÃªt immobilier en 2026 ?</h2>
          <p class="ai-response text-gray-700">
            MensualitÃ© = (capital Ã— i Ã— (1+i)^n) / ((1+i)^n âˆ’ 1) + assurance (approx.).
            Les frais (dossier, garantie) sont gÃ©nÃ©ralement payÃ©s Ã  part et influencent le coÃ»t total et le TAEG.
          </p>
        </section>

        <!-- AI Section: RÃ©sumÃ© rapide -->
        <section class="ai-summary mb-6">
          <h3 class="text-lg font-bold text-gray-900 mb-3">ðŸ“Œ RÃ©sumÃ© rapide</h3>
          <ul class="space-y-2 text-gray-700">
            <li><strong>Source:</strong> Banque de France (publications et seuils observÃ©s) & conditions bancaires 2026</li>
            <li><strong>Calcul:</strong> Capital + intÃ©rÃªts (annuitÃ© constante, taux fixe) + assurance + frais (dossier, garantie)</li>
            <li><strong>ParticularitÃ©:</strong> Taux d'endettement indicatif ~35% (assurance incluse) | Taux d'usure variable | PTZ possible primo-accÃ©dants</li>
            <li><strong>Outil:</strong> Simulation gratuite, taux actualisÃ©s janvier 2026</li>
          </ul>
        </section>

        <p class="text-lg text-gray-600 leading-relaxed mb-4">
          Simulez votre prÃªt immobilier 2026 avec prÃ©cision ! Notre calculateur
          intÃ¨gre les taux actuels, l'assurance emprunteur et tous les frais
          annexes pour vous donner une vision complÃ¨te de votre financement.
          DÃ©couvrez votre capacitÃ© d'emprunt maximale et optimisez vos
          mensualitÃ©s selon votre profil.
        </p>
        <p class="text-lg text-gray-600 leading-relaxed">
          Particulier ou investisseur, rÃ©sidence principale ou secondaire, notre
          outil s'adapte Ã  votre projet. Simulations instantanÃ©es basÃ©es sur les
          conditions bancaires 2026, avec prise en compte du taux d'usure, des
          frais de dossier et de garantie. PrÃ©parez sereinement votre
          rendez-vous bancaire avec des chiffres fiables et argumentÃ©s. Pour
          plus de dÃ©tails (publications et seuils observÃ©s), consultez la
          <a href="https://www.banque-france.fr/fr/a-votre-service/particuliers/connaitre-pratiques-bancaires-assurance/credit/taux-usure" target="_blank" rel="noopener" class="text-blue-600 hover:underline">Banque de France</a>.
        </p>
        <div class="bg-blue-50 border border-blue-200 rounded-lg p-4 mt-4">
          <p class="text-sm text-blue-800">
            <strong>Taux d'usure :</strong> le plafond lÃ©gal Ã©volue tous les mois. Ajustez vos simulations en consÃ©quence et vÃ©rifiez le taux d'usure en vigueur auprÃ¨s de la Banque de France.
          </p>
        </div>
      </section>

      <!-- Feature Cards -->
      <section class="bg-gradient-to-r from-blue-50 to-indigo-50 rounded-lg p-8 mb-12">
        <div class="space-y-4">
          <div class="grid md:grid-cols-3 gap-4">
            <div class="bg-white rounded-lg p-4 shadow-sm">
              <div class="text-3xl mb-2">ðŸ“Š</div>
              <h3 class="font-bold text-gray-900 mb-1">
                CapacitÃ© d'emprunt estimÃ©e
              </h3>
              <p class="text-sm text-gray-600">
                Calculez votre capacitÃ© d'emprunt maximale selon vos revenus et
                charges (taux d'endettement indicatif ~35%)
              </p>
            </div>
            <div class="bg-white rounded-lg p-4 shadow-sm">
              <div class="text-3xl mb-2">ðŸ’³</div>
              <h3 class="font-bold text-gray-900 mb-1">MensualitÃ©s prÃ©cises</h3>
              <p class="text-sm text-gray-600">
                IntÃ©gration du taux nominal, assurance emprunteur, frais de
                dossier et de garantie
              </p>
            </div>
            <div class="bg-white rounded-lg p-4 shadow-sm">
              <div class="text-3xl mb-2">ðŸ”„</div>
              <h3 class="font-bold text-gray-900 mb-1">
                Comparaison multi-durÃ©es
              </h3>
              <p class="text-sm text-gray-600">
                Comparez plusieurs scÃ©narios de durÃ©e et taux pour optimiser
                votre financement
              </p>
            </div>
          </div>
        </div>
      </section>

      <section class="bg-white rounded-lg shadow-lg p-8 mb-12">
        <p class="text-gray-600 mb-6">
          Cette page est une simulation indicative : elle aide Ã  comprendre les
          ordres de grandeur (mensualitÃ©, coÃ»t total, endettement) avant de
          comparer des scÃ©narios et de demander une offre de prÃªt.
        </p>

        <h2 class="text-2xl font-bold text-gray-900 mb-3">
          Comment fonctionne une simulation de prÃªt immobilier ?
        </h2>
        <p class="text-gray-600 mb-4">
          Une simulation de prÃªt immobilier consiste Ã  estimer une mensualitÃ© et
          un coÃ»t total Ã  partir de quelques paramÃ¨tres : montant empruntÃ©,
          durÃ©e, taux nominal et assurance. Le simulateur ciâ€‘dessus fournit une
          estimation indicative (taux fixe), utile pour prÃ©parer un projet et
          comparer des scÃ©narios.
        </p>

        <h2 class="text-2xl font-bold text-gray-900 mt-8 mb-3">
          CapacitÃ© dâ€™emprunt : comment lâ€™estimer ?
        </h2>
        <p class="text-gray-600 mb-4">
          La capacitÃ© dâ€™emprunt dÃ©pend de vos revenus, de vos charges rÃ©currentes
          et dâ€™un seuil dâ€™endettement indicatif (souvent autour de 35% assurance
          incluse). Le simulateur affiche Ã  la fois un taux dâ€™endettement
          (bancaire indicatif) et un indicateur dâ€™effort (reste Ã  vivre) pour
          mieux comprendre votre marge.
        </p>

        <h2 class="text-2xl font-bold text-gray-900 mt-8 mb-3">
          Simulation prÃªt immobilier : mensualitÃ© et coÃ»t total
        </h2>
        <p class="text-gray-600 mb-4">
          La mensualitÃ© totale regroupe gÃ©nÃ©ralement capital + intÃ©rÃªts +
          assurance (selon lâ€™hypothÃ¨se retenue). Le coÃ»t total sur la durÃ©e
          dÃ©pend surtout de la durÃ©e et du taux : une durÃ©e plus longue rÃ©duit
          la mensualitÃ© mais augmente souvent le coÃ»t total.
        </p>

        <h2 class="text-2xl font-bold text-gray-900 mt-8 mb-3">
          PrÃªt immobilier vs prÃªt conso / auto : quelles diffÃ©rences ?
        </h2>
        <p class="text-gray-600 mb-4">
          Un prÃªt immobilier finance un bien immobilier sur des durÃ©es longues,
          avec des frais spÃ©cifiques (garantie, dossier, notaire). Un prÃªt conso
          ou auto finance un achat avec des durÃ©es plus courtes et des rÃ¨gles
          diffÃ©rentes. Pour une estimation dÃ©diÃ©e au crÃ©dit conso, utilisez
          notre <a href="/pages/financement.html" class="text-blue-600 hover:underline">simulateur de financement</a>.
        </p>

        <h2 class="text-2xl font-bold text-gray-900 mt-8 mb-3">
          Frais Ã  prÃ©voir en plus du prÃªt
        </h2>
        <p class="text-gray-600 mb-3">
          En plus des mensualitÃ©s, un projet immobilier implique souvent des
          frais et charges Ã  anticiper :
        </p>
        <ul class="text-gray-600 space-y-2 ml-4 list-disc list-inside mb-4">
          <li>
            <a href="/pages/notaire.html" class="text-blue-600 hover:underline">Frais de notaire</a> (achat)
          </li>
          <li>Assurance emprunteur (coÃ»t variable selon lâ€™offre)</li>
          <li>
            <a href="/pages/taxe.html" class="text-blue-600 hover:underline">Taxe fonciÃ¨re</a> (annuelle)
          </li>
          <li>
            <a href="/pages/charges.html" class="text-blue-600 hover:underline">Charges de copropriÃ©tÃ©</a> (si copro)
          </li>
        </ul>

        <h2 class="text-2xl font-bold text-gray-900 mt-8 mb-3">
          Exemples concrets (indicatifs)
        </h2>
        <div class="grid md:grid-cols-2 gap-4">
          <div class="bg-gray-50 border border-gray-200 rounded-lg p-4">
            <p class="font-semibold text-gray-900 mb-2">Exemple 1</p>
            <p class="text-sm text-gray-700 m-0">
              250 000â‚¬ sur 20 ans Ã  4% (taux indicatif) + assurance 0,36% :
              mensualitÃ© totale autour de 1 550â‚¬â€“1 650â‚¬ / mois selon hypothÃ¨ses.
            </p>
          </div>
          <div class="bg-gray-50 border border-gray-200 rounded-lg p-4">
            <p class="font-semibold text-gray-900 mb-2">Exemple 2</p>
            <p class="text-sm text-gray-700 m-0">
              300 000â‚¬ sur 25 ans Ã  4,2% + assurance 0,36% :
              mensualitÃ© totale autour de 1 700â‚¬â€“1 900â‚¬ / mois selon hypothÃ¨ses.
            </p>
          </div>
        </div>
        <p class="text-xs text-gray-500 mt-3">
          Ces exemples sont indicatifs et non contractuels. Le rÃ©sultat rÃ©el
          dÃ©pend des conditions exactes de lâ€™offre et des frais appliquÃ©s.
        </p>
      </section>

      <!-- FAQ Schema.org -->
      <section class="mt-12">
        <h2 class="text-2xl font-bold text-gray-900 mb-6">
          â“ Questions frÃ©quentes
        </h2>

        <div class="space-y-4">
          <div
            class="bg-white rounded-lg p-6 shadow-sm"
          >
                  <div class="flex flex-col items-center mb-8">
                    <button
                      data-scroll-target="#calculator-container"
                      data-scroll-focus="input, select, textarea"
                      class="bg-green-600 hover:bg-green-700 text-white font-bold py-3 px-8 rounded-xl text-lg transition-colors shadow-lg mt-2"
                    >
                      ðŸŸ¢ Lancer la simulation
                    </button>
                  </div>
                bancaires 2026.
              </p>
            </div>
          </div>

          <div
            class="bg-white rounded-lg p-6 shadow-sm"
          >
            <h3
              class="text-lg font-semibold text-gray-800 mb-3"
            >
              Quels sont les taux de prÃªt immobilier en 2026 ?
            </h3>
            <div>
              <p class="text-gray-600">
                Les taux varient selon la durÃ©e (15-25 ans) et votre profil.
                Notre calculateur utilise les taux moyens 2026 observÃ©s :
                environ 3,5-4,5% pour un excellent profil sur 20 ans.
              </p>
            </div>
          </div>

          <div class="bg-white rounded-lg p-6 shadow-sm">
            <h3 class="text-lg font-semibold text-gray-800 mb-3">
              Comment simuler un prÃªt immobilier ?
            </h3>
            <div>
              <p class="text-gray-600">
                Renseignez le prix du bien, lâ€™apport, la durÃ©e, le taux nominal
                et lâ€™assurance. Le simulateur calcule la mensualitÃ©, le coÃ»t
                total et des indicateurs (endettement/effort) pour comparer vos
                scÃ©narios.
              </p>
            </div>
          </div>

          <div class="bg-white rounded-lg p-6 shadow-sm">
            <h3 class="text-lg font-semibold text-gray-800 mb-3">
              Comment calculer un prÃªt immobilier ?
            </h3>
            <div>
              <p class="text-gray-600">
                Le calcul dâ€™un prÃªt immobilier repose sur le montant empruntÃ©,
                la durÃ©e, le taux dâ€™intÃ©rÃªt et lâ€™assurance. La mensualitÃ© est
                calculÃ©e selon une formule dâ€™annuitÃ© constante. Le plus simple
                reste dâ€™utiliser un simulateur pour obtenir une estimation
                adaptÃ©e Ã  votre situation.
              </p>
            </div>
          </div>

          <div class="bg-white rounded-lg p-6 shadow-sm">
            <h3 class="text-lg font-semibold text-gray-800 mb-3">
              Peut-on simuler sans passer par une banque ?
            </h3>
            <div>
              <p class="text-gray-600">
                Oui : une simulation sert Ã  obtenir un ordre de grandeur et Ã 
                prÃ©parer votre projet. Elle ne remplace pas une offre de prÃªt :
                la dÃ©cision finale et les conditions exactes dÃ©pendent de
                lâ€™Ã©tablissement prÃªteur.
              </p>
            </div>
          </div>

          <div class="bg-white rounded-lg p-6 shadow-sm">
            <h3 class="text-lg font-semibold text-gray-800 mb-3">
              Le simulateur donne-t-il un accord de prÃªt ?
            </h3>
            <div>
              <p class="text-gray-600">
                Non. Le simulateur fournit une estimation indicative. Un accord
                dÃ©pend dâ€™une analyse complÃ¨te (revenus, charges, stabilitÃ©,
                apport, taux dâ€™usure, etc.) et de lâ€™offre de prÃªt.
              </p>
            </div>
          </div>

          <div class="bg-white rounded-lg p-6 shadow-sm">
            <h3 class="text-lg font-semibold text-gray-800 mb-3">
              Quel salaire pour emprunter X â‚¬ ?
            </h3>
            <div>
              <p class="text-gray-600">
                Il nâ€™existe pas un salaire unique : cela dÃ©pend de la durÃ©e, du
                taux, de lâ€™assurance et de vos charges rÃ©currentes. Une rÃ¨gle
                indicative consiste Ã  vÃ©rifier que (mensualitÃ© + charges)
                reprÃ©sente une part raisonnable de vos revenus (souvent ~35%
                assurance incluse). Le simulateur vous donne directement
                lâ€™endettement et lâ€™effort pour tester plusieurs scÃ©narios.
              </p>
            </div>
          </div>

          <div class="bg-white rounded-lg p-6 shadow-sm">
            <h3 class="text-lg font-semibold text-gray-800 mb-3">
              Quelle durÃ©e choisir ?
            </h3>
            <div>
              <p class="text-gray-600">
                Une durÃ©e plus courte rÃ©duit gÃ©nÃ©ralement le coÃ»t total mais
                augmente la mensualitÃ©. Une durÃ©e plus longue baisse la
                mensualitÃ© mais augmente souvent le coÃ»t total. Comparez 15, 20
                et 25 ans pour trouver le bon Ã©quilibre avec votre budget.
              </p>
            </div>
          </div>

          <div
            class="bg-white rounded-lg p-6 shadow-sm"
          >
            <h3
              class="text-lg font-semibold text-gray-800 mb-3"
            >
              L'assurance emprunteur est-elle obligatoire ?
            </h3>
            <div>
              <p class="text-gray-600">
                LÃ©galement non, mais exigÃ©e par toutes les banques. Comptez
                0,3-0,6% du capital selon votre Ã¢ge et santÃ©. Vous pouvez
                choisir votre assureur depuis la loi Lemoine.
              </p>
            </div>
          </div>

          <div
            class="bg-white rounded-lg p-6 shadow-sm"
          >
            <h3
              class="text-lg font-semibold text-gray-800 mb-3"
            >
              Quels frais annexes prÃ©voir ?
            </h3>
            <div>
              <p class="text-gray-600">
                Frais de dossier (0,5-1%), garantie hypothÃ©caire ou caution
                (1-2%), frais de courtage Ã©ventuels. Notre simulateur intÃ¨gre
                tous ces coÃ»ts pour un calcul rÃ©aliste.
              </p>
            </div>
          </div>

          <div
            class="bg-white rounded-lg p-6 shadow-sm"
          >
            <h3
              class="text-lg font-semibold text-gray-800 mb-3"
            >
              Puis-je emprunter seul ou Ã  deux ?
            </h3>
            <div>
              <p class="text-gray-600">
                L'emprunt Ã  deux augmente la capacitÃ© (cumul des revenus) mais
                engage solidairement. Notre calculateur permet de simuler les
                deux situations pour optimiser votre dossier.
              </p>
            </div>
          </div>
        </div>
      </section>

      </section>    </main>

    <section class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 mt-8">
      <div class="bg-white border-2 border-gray-200 rounded-lg p-6">
        <h3 class="text-xl font-bold text-gray-900 mb-3">ðŸ”— Voir aussi</h3>
        <p class="text-sm text-gray-600 mb-3">
          Parcours immobilier :
          <a href="/pages/apl.html" class="text-blue-700 hover:underline">APL</a>
          â†’
          <a href="/pages/pret.html" class="text-blue-700 hover:underline">PrÃªt</a>
          â†’
          <a href="/pages/notaire.html" class="text-blue-700 hover:underline">Notaire</a>
          â†’
          <a href="/pages/taxe.html" class="text-blue-700 hover:underline">Taxe</a>
          â†’
          <a href="/pages/charges.html" class="text-blue-700 hover:underline">Charges</a>
        </p>
        <div class="flex flex-wrap gap-3">
          <a href="/pages/apl.html" class="inline-block bg-white border border-gray-300 rounded px-3 py-2 text-sm text-blue-700 hover:bg-blue-50">APL 2026</a>
          <a href="/pages/notaire.html" class="inline-block bg-white border border-gray-300 rounded px-3 py-2 text-sm text-blue-700 hover:bg-blue-50">Frais de notaire</a>
          <a href="/pages/plusvalue.html" class="inline-block bg-white border border-gray-300 rounded px-3 py-2 text-sm text-blue-700 hover:bg-blue-50">Plusâ€‘value immobiliÃ¨re</a>
          <a href="/pages/charges.html" class="inline-block bg-white border border-gray-300 rounded px-3 py-2 text-sm text-blue-700 hover:bg-blue-50">Charges de copropriÃ©tÃ©</a>
          <a href="/pages/taxe.html" class="inline-block bg-white border border-gray-300 rounded px-3 py-2 text-sm text-blue-700 hover:bg-blue-50">Taxe fonciÃ¨re</a>
          <a href="/pages/impot.html" class="inline-block bg-white border border-gray-300 rounded px-3 py-2 text-sm text-blue-700 hover:bg-blue-50">ImpÃ´t sur le revenu</a>
          <a href="/pages/ik.html" class="inline-block bg-white border border-gray-300 rounded px-3 py-2 text-sm text-blue-700 hover:bg-blue-50">IndemnitÃ©s kilomÃ©triques (IK)</a>
          <a href="/pages/travail.html" class="inline-block bg-white border border-gray-300 rounded px-3 py-2 text-sm text-blue-700 hover:bg-blue-50">Temps de travail</a>
          <a href="/pages/blog/frais-notaire-departements.html" class="inline-block bg-blue-600 text-white rounded px-4 py-2 text-sm font-semibold shadow hover:bg-blue-700">Tous les dÃ©partements</a>
          <a href="/pages/blog.html" class="inline-block bg-white border border-gray-300 rounded px-3 py-2 text-sm text-blue-700 hover:bg-blue-50">Blog</a>
        </div>
      </div>
    </section>

    <section class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 mt-8">
      <div class="mt-12 bg-gray-100 rounded-lg p-6">
        <h3 class="font-bold text-gray-900 mb-3">ðŸ“š Sources et rÃ©fÃ©rences officielles</h3>
        <ul class="text-sm text-gray-700 space-y-2">
          <li>
            â€¢ Taux d'usure et informations officielles:
            <a href="https://www.banque-france.fr/fr/a-votre-service/particuliers/connaitre-pratiques-bancaires-assurance/credit/taux-usure" target="_blank" rel="noopener" class="text-blue-600 hover:underline">Banque de France</a>
          </li>
          <li>
            â€¢ PrÃªt Ã  Taux ZÃ©ro (PTZ):
            <a href="https://www.service-public.fr/particuliers/vosdroits/F10871" target="_blank" rel="noopener" class="text-blue-600 hover:underline">service-public.fr</a>
          </li>
          <li>
            â€¢ Assurance emprunteur (rÃ¨gles et dÃ©marches):
            <a href="https://www.service-public.fr/particuliers/actualites/A15916" target="_blank" rel="noopener" class="text-blue-600 hover:underline">service-public.fr</a>
          </li>
        </ul>
      </div>
    </section>

    <footer class="bg-gray-800 text-white py-8 mt-16">
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="flex flex-col items-center space-y-4">
          <p class="text-gray-300">
            Â© 2026 Les Calculateurs - PrÃªt immobilier selon barÃ¨mes officiels
          </p>
          <div class="flex gap-4 text-sm">
            <a href="/pages/methodologie" class="text-gray-300 hover:text-white transition-colors">ðŸ“š Notre MÃ©thodologie</a>
            <span class="text-gray-500">|</span>
            <a href="/pages/sources" class="text-gray-300 hover:text-white transition-colors">ðŸ›ï¸ Sources Officielles</a>
          </div>
        </div>
      </div>
    </footer>

    <script type="module" src="../main.ts"></script>
    <script type="module">
      import { CalculatorFrame } from "../components/CalculatorFrame.ts";
      import { formatCurrency } from "../main.ts";

      const pretConfig = {
        title: "Simulateur de prÃªt immobilier 2026",
        description:
          "Simulation complÃ¨te : capacitÃ© d'emprunt, mensualitÃ©s, assurance, frais de dossier.",
        fields: [
          {
            id: "prix_bien",
            label: "Prix du bien immobilier (â‚¬) *",
            type: "number",
            required: true,
            placeholder: "300000",
            min: 10000,
            step: 1000,
          },
          {
            id: "apport_personnel",
            label: "Apport personnel (â‚¬) *",
            type: "number",
            required: true,
            placeholder: "50000",
            min: 0,
            step: 1000,
          },
          {
            id: "duree",
            label: "DurÃ©e du prÃªt *",
            type: "select",
            required: true,
            options: [
              { value: "10", label: "10 ans" },
              { value: "15", label: "15 ans" },
              { value: "20", label: "20 ans" },
              { value: "25", label: "25 ans" },
              { value: "30", label: "30 ans" },
            ],
          },
          {
            id: "taux_nominal",
            label: "Taux d'intÃ©rÃªt nominal (%/an) *",
            type: "number",
            required: true,
            placeholder: "4.0",
            min: 0.1,
            max: 10,
            step: 0.1,
          },
          {
            id: "revenus_emprunteur1",
            label: "Revenus mensuels (â‚¬) emprunteur 1 *",
            type: "number",
            required: true,
            placeholder: "3500",
            min: 1000,
            step: 100,
          },
          {
            id: "revenus_emprunteur2",
            label: "Revenus mensuels (â‚¬) emprunteur 2 (optionnel)",
            type: "number",
            placeholder: "0",
            min: 0,
            step: 100,
          },
          {
            id: "charges_mensuelles",
            label: "Charges mensuelles (â‚¬) existantes (optionnel)",
            type: "number",
            placeholder: "0",
            min: 0,
            step: 50,
          },
          {
            id: "assurance_taux",
            label: "Taux d'assurance emprunteur (%/an)",
            type: "number",
            placeholder: "0.36",
            min: 0.1,
            max: 2,
            step: 0.01,
          },
          {
            id: "frais_dossier",
            label: "Frais de dossier (â‚¬) (optionnel)",
            type: "number",
            placeholder: "0",
            min: 0,
            step: 100,
          },
          {
            id: "frais_garantie",
            label: "Frais de garantie (â‚¬) (optionnel)",
            type: "number",
            placeholder: "0",
            min: 0,
            step: 100,
          },
        ],
        calculate: (values) => {
          try {
            const prixBien = Number(values.prix_bien) || 0;
            const apportPersonnel = Number(values.apport_personnel) || 0;
            const montantEmprunte = prixBien - apportPersonnel;

            if (montantEmprunte <= 0) {
              return {
                success: false,
                error:
                  "L'apport ne peut pas Ãªtre supÃ©rieur ou Ã©gal au prix du bien",
              };
            }

            const dureeAnnees = parseInt(values.duree) || 20;
            const dureeMois = dureeAnnees * 12;
            const tauxNominal = (Number(values.taux_nominal) || 0) / 100;
            const tauxMensuel = tauxNominal / 12;

            const revenusMensuels =
              (Number(values.revenus_emprunteur1) || 0) +
              (Number(values.revenus_emprunteur2) || 0);
            const chargesMensuelles = Number(values.charges_mensuelles) || 0;
            const revenusDisponibles = Math.max(0, revenusMensuels - chargesMensuelles);

            if (revenusMensuels <= 0) {
              return {
                success: false,
                error: "Veuillez saisir des revenus mensuels valides.",
              };
            }
            if (revenusDisponibles <= 0) {
              return {
                success: false,
                error:
                  "Les charges mensuelles ne peuvent pas Ãªtre supÃ©rieures ou Ã©gales aux revenus.",
              };
            }

            const tauxAssurance = (Number(values.assurance_taux) || 0) / 100;
            const fraisDossier = Number(values.frais_dossier) || 0;
            const fraisGarantie = Number(values.frais_garantie) || 0;

            // Calcul de la mensualitÃ© capital + intÃ©rÃªts
            let mensualiteCapitalInterets = 0;
            if (tauxMensuel > 0) {
              mensualiteCapitalInterets =
                (montantEmprunte *
                  tauxMensuel *
                  Math.pow(1 + tauxMensuel, dureeMois)) /
                (Math.pow(1 + tauxMensuel, dureeMois) - 1);
            } else {
              mensualiteCapitalInterets = montantEmprunte / dureeMois;
            }

            // Assurance (sur capital empruntÃ©)
            const assuranceMensuelle = (montantEmprunte * tauxAssurance) / 12;

            // MensualitÃ© totale
            const mensualiteTotale =
              mensualiteCapitalInterets + assuranceMensuelle;

            const coutTotalInterets =
              mensualiteCapitalInterets * dureeMois - montantEmprunte;
            const coutTotalAssurance = assuranceMensuelle * dureeMois;
            const coutTotalHorsFrais =
              (mensualiteCapitalInterets + assuranceMensuelle) * dureeMois -
              montantEmprunte;
            const coutTotalFrais = fraisDossier + fraisGarantie;
            const coutTotalAvecFrais = coutTotalHorsFrais + coutTotalFrais;

            const tauxEffort = (mensualiteTotale / revenusDisponibles) * 100;

            const tauxEndettement = ((mensualiteTotale + chargesMensuelles) / revenusMensuels) * 100;
            const tauxEndettementMax = 35;
            const mensualiteMax = Math.max(
              0,
              revenusMensuels * (tauxEndettementMax / 100) - chargesMensuelles
            );
            const capaciteRestante = Math.max(0, mensualiteMax - mensualiteTotale);

            const netPerÃ§u = montantEmprunte - fraisDossier - fraisGarantie;
            const paymentMensuel = mensualiteCapitalInterets + assuranceMensuelle;
            const computePV = (r) => {
              if (r <= 0) return paymentMensuel * dureeMois;
              let pv = 0;
              let denom = 1 + r;
              let factor = denom;
              for (let k = 1; k <= dureeMois; k++) {
                pv += paymentMensuel / factor;
                factor *= denom;
              }
              return pv;
            };

            let taeg = null;
            if (netPerÃ§u > 0 && paymentMensuel > 0) {
              let low = 0;
              let high = 1;
              while (computePV(high) > netPerÃ§u && high < 10) {
                high *= 2;
              }
              if (computePV(high) <= netPerÃ§u) {
                for (let i = 0; i < 60; i++) {
                  const mid = (low + high) / 2;
                  const pv = computePV(mid);
                  if (pv > netPerÃ§u) low = mid;
                  else high = mid;
                }
                const rMensuel = (low + high) / 2;
                taeg = (Math.pow(1 + rMensuel, 12) - 1) * 100;
              }
            }

            return {
              success: true,
              data: {
                prixBien,
                apportPersonnel,
                montantEmprunte,
                dureeAnnees,
                tauxNominal: tauxNominal * 100,
                mensualiteCapitalInterets,
                assuranceMensuelle,
                mensualiteTotale,
                coutTotalInterets,
                coutTotalAssurance,
                coutTotalHorsFrais,
                coutTotalFrais,
                coutTotalAvecFrais,
                tauxEndettement,
                tauxEffort,
                capaciteRestante,
                revenusMensuels,
                chargesMensuelles,
                revenusDisponibles,
                mensualiteMax,
                tauxEndettementMax,
                fraisDossier,
                fraisGarantie,
                taeg,
              },
            };
          } catch (error) {
            return {
              success: false,
              error: "Erreur dans le calcul du prÃªt immobilier",
            };
          }
        },
        /**
         * Formate lâ€™affichage des rÃ©sultats (totaux, dÃ©tails, conseils) Ã  partir des donnÃ©es calculÃ©es.
         * Produit un bloc HTML prÃªt Ã  injecter dans lâ€™interface du calculateur.
         */
        formatResult: (result) => {
          const data = result.data;
          const endettementOk = data.tauxEndettement <= data.tauxEndettementMax;
          const taegText =
            typeof data.taeg === "number" && isFinite(data.taeg)
              ? `${data.taeg.toFixed(2)}%`
              : "â€”";

          return `
          <div class="space-y-6">
            <div class="bg-white rounded-lg p-6 border border-gray-200 shadow-sm">
              <h3 class="text-xl font-bold text-gray-900 mb-4">ðŸŽ¯ RÃ©sultat principal</h3>
              <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                <div class="bg-purple-50 border border-purple-200 rounded-lg p-4">
                  <p class="text-sm text-gray-600">MensualitÃ© totale</p>
                  <p class="text-2xl font-bold text-purple-700">${formatCurrency(
                    data.mensualiteTotale
                  )}</p>
                </div>
                <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
                  <p class="text-sm text-gray-600">Montant empruntÃ©</p>
                  <p class="text-2xl font-bold text-blue-700">${formatCurrency(
                    data.montantEmprunte
                  )}</p>
                </div>
                <div class="bg-green-50 border border-green-200 rounded-lg p-4">
                  <p class="text-sm text-gray-600">DurÃ©e</p>
                  <p class="text-2xl font-bold text-green-700">${data.dureeAnnees} ans</p>
                </div>
              </div>
              <p class="text-sm text-gray-600 mt-3 m-0">
                Prix du bien : <strong>${formatCurrency(
                  data.prixBien
                )}</strong> â€¢ Apport : <strong>${formatCurrency(
                  data.apportPersonnel
                )}</strong>
              </p>
            </div>

            <div class="bg-blue-50 border-l-4 border-blue-500 p-6 rounded-r-lg">
              <h3 class="text-lg font-bold text-blue-900 mb-2">ðŸ§  Logique de calcul (simplifiÃ©e)</h3>
              <ul class="text-sm text-blue-900 list-disc list-inside space-y-1">
                <li>MensualitÃ© = capital + intÃ©rÃªts (annuitÃ© constante, taux fixe) + assurance (approx.)</li>
                <li>Taux d'endettement (bancaire indicatif) = (mensualitÃ© + charges) / revenus</li>
                <li>Taux d'effort (indicatif) = mensualitÃ© / (revenus âˆ’ charges)</li>
                <li>TAEG estimÃ© : intÃ¨gre assurance et frais (hypothÃ¨ses simplifiÃ©es)</li>
              </ul>
            </div>

            <div class="bg-white border border-gray-200 rounded-lg p-6">
              <h3 class="text-lg font-bold text-gray-900 mb-3">ðŸ“Š DÃ©tail chiffrÃ©</h3>
              <div class="overflow-x-auto">
                <table class="w-full text-sm border-collapse">
                  <tbody>
                    <tr class="border-b"><td class="p-3 text-gray-600">MensualitÃ© capital + intÃ©rÃªts</td><td class="p-3 text-right font-semibold text-gray-900">${formatCurrency(
                      data.mensualiteCapitalInterets
                    )}</td></tr>
                    <tr class="border-b"><td class="p-3 text-gray-600">Assurance mensuelle (approx.)</td><td class="p-3 text-right font-semibold text-gray-900">${formatCurrency(
                      data.assuranceMensuelle
                    )}</td></tr>
                    <tr class="border-b bg-gray-50"><td class="p-3 font-bold text-gray-900">MensualitÃ© totale</td><td class="p-3 text-right font-bold text-purple-700">${formatCurrency(
                      data.mensualiteTotale
                    )}</td></tr>
                    <tr class="border-b"><td class="p-3 text-gray-600">Taux nominal</td><td class="p-3 text-right font-semibold text-gray-900">${data.tauxNominal.toFixed(
                      2
                    )}%</td></tr>
                    <tr class="border-b"><td class="p-3 text-gray-600">TAEG estimÃ© (assurance + frais)</td><td class="p-3 text-right font-semibold text-gray-900">${taegText}</td></tr>
                    <tr class="border-b"><td class="p-3 text-gray-600">Frais de dossier</td><td class="p-3 text-right font-semibold text-gray-900">${formatCurrency(
                      data.fraisDossier
                    )}</td></tr>
                    <tr class="border-b"><td class="p-3 text-gray-600">Frais de garantie</td><td class="p-3 text-right font-semibold text-gray-900">${formatCurrency(
                      data.fraisGarantie
                    )}</td></tr>
                    <tr class="border-b"><td class="p-3 text-gray-600">CoÃ»t total intÃ©rÃªts</td><td class="p-3 text-right font-semibold text-gray-900">${formatCurrency(
                      data.coutTotalInterets
                    )}</td></tr>
                    <tr class="border-b"><td class="p-3 text-gray-600">CoÃ»t total assurance</td><td class="p-3 text-right font-semibold text-gray-900">${formatCurrency(
                      data.coutTotalAssurance
                    )}</td></tr>
                    <tr class="border-b"><td class="p-3 text-gray-600">CoÃ»t total hors frais</td><td class="p-3 text-right font-semibold text-gray-900">${formatCurrency(
                      data.coutTotalHorsFrais
                    )}</td></tr>
                    <tr class="bg-gray-50"><td class="p-3 font-bold text-gray-900">CoÃ»t total avec frais</td><td class="p-3 text-right font-bold text-red-700">${formatCurrency(
                      data.coutTotalAvecFrais
                    )}</td></tr>
                  </tbody>
                </table>
              </div>
              <p class="text-xs text-gray-600 mt-3 m-0">
                L'assurance est ici estimÃ©e sur le capital initial, selon un taux annuel indicatif. Les modalitÃ©s rÃ©elles (capital restant dÃ», quotitÃ©, Ã¢ge, santÃ©) peuvent modifier le coÃ»t final.
              </p>
              <p class="text-xs text-gray-600 mt-2 m-0">
                Le TAEG affichÃ© est une estimation. Le TAEG contractuel dÃ©pend des conditions exactes de l'offre de prÃªt et des frais rÃ©els appliquÃ©s par l'Ã©tablissement.
              </p>
            </div>

            <div class="${
              endettementOk
                ? "bg-green-50 border-green-200"
                : "bg-red-50 border-red-200"
            } border rounded-lg p-4">
              <h4 class="font-semibold ${
                endettementOk ? "text-green-800" : "text-red-800"
              } mb-2">
                ${
                  endettementOk ? "âœ…" : "âš ï¸"
                } Taux d'endettement (bancaire indicatif) : ${data.tauxEndettement.toFixed(1)}%
              </h4>
              <p class="text-sm ${
                endettementOk ? "text-green-700" : "text-red-700"
              }">
                ${
                  endettementOk
                    ? `Votre taux d'endettement est acceptable (â‰¤ ${data.tauxEndettementMax}%). CapacitÃ© restante : ${formatCurrency(
                        data.capaciteRestante
                      )}/mois`
                    : `Attention : votre taux d'endettement dÃ©passe ${data.tauxEndettementMax}%. Le prÃªt pourrait Ãªtre refusÃ© ou nÃ©cessiter des ajustements.`
                }
              </p>
              <p class="text-xs mt-2 ${
                endettementOk ? "text-green-600" : "text-red-600"
              }">
                Revenus : ${formatCurrency(
                  data.revenusMensuels
                )} â€¢ Charges : ${formatCurrency(
                  data.chargesMensuelles
                )} â€¢ Revenus disponibles : ${formatCurrency(
                  data.revenusDisponibles
                )} â€¢ Seuil ${data.tauxEndettementMax}% : ${formatCurrency(
                  data.mensualiteMax
                )}
              </p>
              <p class="text-xs text-gray-600 mt-2 m-0">
                Indicateur d'effort (reste Ã  vivre) : ${data.tauxEffort.toFixed(
                  1
                )}%.
              </p>
            </div>

            <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
              <p class="text-sm text-blue-800">
                <strong>ðŸ’¡ Conseil :</strong> Cette simulation est indicative. Les banques Ã©tudient aussi votre profil, 
                apport, stabilitÃ© professionnelle, et peuvent proposer des conditions diffÃ©rentes.
              </p>
            </div>
          </div>
          `;
        },
        exportCSV: {
          enabled: true,
          filename: "pret-immobilier-estimation.csv",
          getCSVData: (result, values) => {
            const d = result.data;
            return {
              headers: ["ParamÃ¨tre", "Valeur"],
              rows: [
                ["Prix du bien (â‚¬)", d.prixBien],
                ["Apport (â‚¬)", d.apportPersonnel],
                ["Montant empruntÃ© (â‚¬)", d.montantEmprunte],
                ["DurÃ©e (annÃ©es)", d.dureeAnnees],
                ["Taux nominal (%/an)", d.tauxNominal.toFixed(2)],
                ["Assurance mensuelle (â‚¬)", d.assuranceMensuelle],
                ["MensualitÃ© totale (â‚¬)", d.mensualiteTotale],
                ["IntÃ©rÃªts totaux (â‚¬)", d.coutTotalInterets],
                ["Assurance totale (â‚¬)", d.coutTotalAssurance],
                ["Frais dossier (â‚¬)", d.fraisDossier],
                ["Frais garantie (â‚¬)", d.fraisGarantie],
                ["CoÃ»t total avec frais (â‚¬)", d.coutTotalAvecFrais],
                ["Revenus mensuels (â‚¬)", d.revenusMensuels],
                ["Charges mensuelles (â‚¬)", d.chargesMensuelles],
                ["Taux d'endettement bancaire indicatif (%)", d.tauxEndettement.toFixed(1)],
                ["Taux d'effort indicatif (%)", d.tauxEffort.toFixed(1)],
                [
                  "TAEG estimÃ© (%)",
                  typeof d.taeg === "number" && isFinite(d.taeg)
                    ? d.taeg.toFixed(2)
                    : "",
                ],
              ],
            };
          },
        },
      };

      // Initialisation du calculateur
      new CalculatorFrame("calculator-container", pretConfig);

      // Event listeners pour comparaison
      import("../components/ComparisonModal.ts").then(({ ComparisonModal }) => {
        const addBtn = document.getElementById("pret-add-to-compare");
        const resetBtn = document.getElementById("pret-reset-compare");

        ComparisonModal.init("pret");
        if (resetBtn && ComparisonModal.count("pret") > 0) {
          resetBtn.classList.remove("hidden");
        }

        if (addBtn && resetBtn) {
          addBtn.addEventListener("click", () => {
            const last = window["dernierCalcul_calculator-container"];
            const lastValues = last?.values || {};

            const modal = new ComparisonModal({
              title: "Ajouter un scÃ©nario Ã  la comparaison",
              fields: [
                {
                  id: "label",
                  label: "Nom du scÃ©nario (optionnel)",
                  type: "text",
                  value: "",
                  placeholder: "Projet rÃ©sidence principale",
                },
                {
                  id: "prix_bien",
                  label: "Prix du bien immobilier (â‚¬)",
                  type: "number",
                  value: lastValues.prix_bien ?? 300000,
                  required: true,
                  min: 10000,
                  step: 1000,
                },
                {
                  id: "apport_personnel",
                  label: "Apport personnel (â‚¬)",
                  type: "number",
                  value: lastValues.apport_personnel ?? 50000,
                  required: true,
                  min: 0,
                  step: 1000,
                },
                {
                  id: "duree",
                  label: "DurÃ©e du prÃªt",
                  type: "select",
                  value: lastValues.duree || "20",
                  required: true,
                  options: [
                    { value: "10", label: "10 ans" },
                    { value: "15", label: "15 ans" },
                    { value: "20", label: "20 ans" },
                    { value: "25", label: "25 ans" },
                    { value: "30", label: "30 ans" },
                  ],
                },
                {
                  id: "taux_nominal",
                  label: "Taux d'intÃ©rÃªt nominal (%/an)",
                  type: "number",
                  value: lastValues.taux_nominal ?? 4.0,
                  required: true,
                  min: 0,
                  max: 10,
                  step: 0.1,
                },
                {
                  id: "assurance_taux",
                  label: "Taux d'assurance emprunteur (%/an)",
                  type: "number",
                  value: lastValues.assurance_taux ?? 0.36,
                  required: true,
                  min: 0,
                  max: 2,
                  step: 0.01,
                },
                {
                  id: "revenus_emprunteur1",
                  label: "Revenus mensuels (â‚¬) emprunteur 1",
                  type: "number",
                  value: lastValues.revenus_emprunteur1 ?? 3500,
                  required: true,
                  min: 0,
                  step: 100,
                },
                {
                  id: "revenus_emprunteur2",
                  label: "Revenus mensuels (â‚¬) emprunteur 2 (optionnel)",
                  type: "number",
                  value: lastValues.revenus_emprunteur2 ?? 0,
                  required: false,
                  min: 0,
                  step: 100,
                },
                {
                  id: "charges_mensuelles",
                  label: "Charges mensuelles (â‚¬) existantes (optionnel)",
                  type: "number",
                  value: lastValues.charges_mensuelles ?? 0,
                  required: false,
                  min: 0,
                  step: 50,
                },
                {
                  id: "frais_dossier",
                  label: "Frais de dossier (â‚¬) (optionnel)",
                  type: "number",
                  value: lastValues.frais_dossier ?? 0,
                  required: false,
                  min: 0,
                  step: 100,
                },
                {
                  id: "frais_garantie",
                  label: "Frais de garantie (â‚¬) (optionnel)",
                  type: "number",
                  value: lastValues.frais_garantie ?? 0,
                  required: false,
                  min: 0,
                  step: 100,
                },
              ],
              onConfirm: (values) => {
                const normalized = {
                  prix_bien: Number(values.prix_bien) || 0,
                  apport_personnel: Number(values.apport_personnel) || 0,
                  duree: String(values.duree || "20"),
                  taux_nominal: Number(values.taux_nominal) || 0,
                  assurance_taux: Number(values.assurance_taux) || 0,
                  revenus_emprunteur1: Number(values.revenus_emprunteur1) || 0,
                  revenus_emprunteur2: Number(values.revenus_emprunteur2) || 0,
                  charges_mensuelles: Number(values.charges_mensuelles) || 0,
                  frais_dossier: Number(values.frais_dossier) || 0,
                  frais_garantie: Number(values.frais_garantie) || 0,
                };

                const computed = pretConfig.calculate(normalized);
                if (!computed?.success) {
                  alert(computed?.error || "Erreur lors du calcul.");
                  return;
                }
                const d = computed.data;
                const labelText = String(values.label || "").trim();
                const autoLabel = `PrÃªt ${d.dureeAnnees} ans â€¢ ${formatCurrency(
                  d.montantEmprunte
                )}`;

                ComparisonModal.addComparison("pret", {
                  label: labelText || autoLabel,
                  mensualite: formatCurrency(d.mensualiteTotale),
                  cout_total: formatCurrency(d.coutTotalAvecFrais),
                  taux_endettement: `${d.tauxEndettement.toFixed(1)}%`,
                  taux_effort: `${d.tauxEffort.toFixed(1)}%`,
                  montant_emprunte: formatCurrency(d.montantEmprunte),
                  taeg: typeof d.taeg === "number" && isFinite(d.taeg) ? `${d.taeg.toFixed(2)}%` : "â€”",
                });

                resetBtn.classList.remove("hidden");
                document
                  .getElementById("pret-comparaison")
                  ?.scrollIntoView({ behavior: "smooth" });
              },
            });

            modal.open();
          });

          resetBtn.addEventListener("click", () => {
            ComparisonModal.resetComparison("pret");
            resetBtn.classList.add("hidden");
          });
        }
      });
    </script>
    
    <!-- Auto-initialisation des exports PDF/CSV -->
    <script type="module">
  const __lcLoadAutoExport = () => import("../utils/autoExportInit.js");
  if ("requestIdleCallback" in window) {
    window.requestIdleCallback(__lcLoadAutoExport, { timeout: 4000 });
  } else {
    window.setTimeout(__lcLoadAutoExport, 2000);
  }
</script>
  <div class="ymyl-officiel-btn" style="text-align:center;margin:20px 0;"><a class="btn-officiel" href="https://www.notaires.fr" target="_blank" rel="noopener" style="display:inline-block;background:#007bff;color:#fff;padding:12px 24px;border-radius:4px;text-decoration:none;font-weight:bold;">ðŸ‘‰ Simulateur officiel notaires.fr</a><p style="font-size:12px;color:#666;margin-top:8px;">Pour un calcul definitif conforme aux baremes officiels</p></div>
</body>
</html>




